
    <!DOCTYPE html>
    <html>
    <head>
        <title>Interactive Phylogenetic Tree - Varanus komodoensis</title>
        <script src="https://d3js.org/d3.v7.min.js"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 20px;
                background-color: #f8f9fa;
            }
            
            .tree-container {
                background: white;
                border-radius: 10px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                padding: 20px;
                margin: 20px 0;
            }
            
            .node circle {
                stroke: #333;
                stroke-width: 2px;
                cursor: pointer;
            }
            
            .node.query circle {
                stroke: #FF0000;
                stroke-width: 4px;
                r: 8;
            }
            
            .node text {
                font: 12px sans-serif;
                cursor: pointer;
            }
            
            .node.query text {
                font-weight: bold;
                font-size: 14px;
            }
            
            .link {
                fill: none;
                stroke: #ccc;
                stroke-width: 2px;
            }
            
            .tooltip {
                position: absolute;
                text-align: left;
                padding: 10px;
                font: 12px sans-serif;
                background: rgba(0, 0, 0, 0.8);
                color: white;
                border-radius: 5px;
                pointer-events: none;
                opacity: 0;
                max-width: 300px;
            }
            
            .legend {
                background: #f8f9fa;
                border: 1px solid #ddd;
                border-radius: 5px;
                padding: 15px;
                margin: 20px 0;
            }
            
            .legend-item {
                display: inline-block;
                margin: 5px 10px;
            }
            
            .legend-color {
                width: 15px;
                height: 15px;
                display: inline-block;
                margin-right: 5px;
                border-radius: 50%;
                border: 1px solid #333;
            }
            
            .controls {
                margin: 20px 0;
                text-align: center;
            }
            
            .btn {
                background: #007bff;
                color: white;
                border: none;
                padding: 8px 16px;
                margin: 0 5px;
                border-radius: 4px;
                cursor: pointer;
            }
            
            .btn:hover {
                background: #0056b3;
            }
            
            .info-panel {
                background: #e9ecef;
                border-radius: 5px;
                padding: 15px;
                margin: 20px 0;
            }
        </style>
    </head>
    <body>
        <h1>ðŸŒ³ Interactive Phylogenetic Tree Analysis</h1>
        
        <div class="info-panel">
            <h3>Query Species: Varanus komodoensis</h3>
            <p><strong>Method:</strong> UPGMA_hierarchical_clustering</p>
            <p><strong>Total Species:</strong> 21</p>
            <p><strong>Analysis Date:</strong> 2025-06-09 18:32:00</p>
        </div>
        
        <div class="controls">
            <button class="btn" onclick="expandAll()">Expand All</button>
            <button class="btn" onclick="collapseAll()">Collapse All</button>
            <button class="btn" onclick="resetZoom()">Reset Zoom</button>
            <button class="btn" onclick="downloadSVG()">Download SVG</button>
        </div>
        
        <div class="legend">
            <h4>ðŸŽ¨ IUCN Conservation Status Legend:</h4>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #FF0000"></span>
                <span>CR - Critically Endangered</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #FF8C00"></span>
                <span>EN - Endangered</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #FFD700"></span>
                <span>VU - Vulnerable</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #9ACD32"></span>
                <span>NT - Near Threatened</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #32CD32"></span>
                <span>LC - Least Concern</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #808080"></span>
                <span>DD - Data Deficient</span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background-color: #0000FF"></span>
                <span>Query Species</span>
            </div>
        </div>
        
        <div class="tree-container">
            <div id="tree"></div>
        </div>
        
        <div class="tooltip"></div>
        
        <script>
            // Tree data
            const treeData = {
  "id": "2b0ls4pf",
  "name": "Inner20",
  "branch_length": 0.0,
  "parent": null,
  "is_leaf": true,
  "children": [
    {
      "id": "cmcyc6nl",
      "name": "Varanus varius",
      "branch_length": 0.49896603875869605,
      "parent": "2b0ls4pf",
      "conservation_status": "LC",
      "conservation_source": "IUCN Red List",
      "iucn_year_published": "2018",
      "possibly_extinct": false,
      "is_leaf": true
    },
    {
      "id": "bjvk64em",
      "name": "Inner19",
      "branch_length": 0.49053478206943457,
      "parent": "2b0ls4pf",
      "is_leaf": true,
      "children": [
        {
          "id": "ybcssuzz",
          "name": "Varanus kingoru",
          "branch_length": 0.008431256689261495,
          "parent": "bjvk64em",
          "conservation_status": "LC",
          "conservation_source": "IUCN Red List (search match)",
          "iucn_year_published": "2018",
          "is_leaf": true
        },
        {
          "id": "sb43vivu",
          "name": "Inner18",
          "branch_length": 0.002366674656617892,
          "parent": "bjvk64em",
          "is_leaf": true,
          "children": [
            {
              "id": "lonh0n7x",
              "name": "Inner15",
              "branch_length": 0.0030321168168034396,
              "parent": "sb43vivu",
              "is_leaf": true,
              "children": [
                {
                  "id": "e3k4vjlr",
                  "name": "Varanus gilleni",
                  "branch_length": 0.0030324652158401633,
                  "parent": "lonh0n7x",
                  "conservation_status": "LC",
                  "conservation_source": "IUCN Red List",
                  "iucn_year_published": "2018",
                  "possibly_extinct": false,
                  "is_leaf": true
                },
                {
                  "id": "7vjm3onw",
                  "name": "Varanus timoren",
                  "branch_length": 0.0030324652158401633,
                  "parent": "lonh0n7x",
                  "conservation_status": "LC",
                  "conservation_source": "IUCN Red List (search match)",
                  "iucn_year_published": "2021",
                  "is_leaf": true
                }
              ],
              "is_internal": true
            },
            {
              "id": "vxlb4iyr",
              "name": "Inner17",
              "branch_length": 0.0015535113048519627,
              "parent": "sb43vivu",
              "is_leaf": true,
              "children": [
                {
                  "id": "25eoslaz",
                  "name": "Varanus gigante",
                  "branch_length": 0.00451107072779164,
                  "parent": "vxlb4iyr",
                  "conservation_status": "LC",
                  "conservation_source": "IUCN Red List (search match)",
                  "iucn_year_published": "2018",
                  "is_leaf": true
                },
                {
                  "id": "bj9zlrnb",
                  "name": "Inner16",
                  "branch_length": 0.0014381912236888887,
                  "parent": "vxlb4iyr",
                  "is_leaf": true,
                  "children": [
                    {
                      "id": "9n9zg3b3",
                      "name": "Varanus melinus",
                      "branch_length": 0.0030728795041027514,
                      "parent": "bj9zlrnb",
                      "conservation_status": "EN",
                      "conservation_source": "IUCN Red List",
                      "iucn_year_published": "2021",
                      "possibly_extinct": false,
                      "is_leaf": true
                    },
                    {
                      "id": "c13g4nq5",
                      "name": "Inner14",
                      "branch_length": 9.598393462362676e-05,
                      "parent": "bj9zlrnb",
                      "is_leaf": true,
                      "children": [
                        {
                          "id": "7eh6z406",
                          "name": "Inner10",
                          "branch_length": 0.0007248441959507657,
                          "parent": "c13g4nq5",
                          "is_leaf": true,
                          "children": [
                            {
                              "id": "7xvdwxmi",
                              "name": "Varanus gouldii",
                              "branch_length": 0.002252051373528359,
                              "parent": "7eh6z406",
                              "conservation_status": "LC",
                              "conservation_source": "IUCN Red List",
                              "iucn_year_published": "2018",
                              "possibly_extinct": false,
                              "is_leaf": true
                            },
                            {
                              "id": "0v0ykdkz",
                              "name": "Inner6",
                              "branch_length": 0.0006020335354976827,
                              "parent": "7eh6z406",
                              "is_leaf": true,
                              "children": [
                                {
                                  "id": "36fycy6i",
                                  "name": "Varanus panopte",
                                  "branch_length": 0.0016500178380306763,
                                  "parent": "0v0ykdkz",
                                  "conservation_status": "LC",
                                  "conservation_source": "IUCN Red List (search match)",
                                  "iucn_year_published": "2018",
                                  "is_leaf": true
                                },
                                {
                                  "id": "tw7cdkdq",
                                  "name": "Inner5",
                                  "branch_length": 0.0003121655369247023,
                                  "parent": "0v0ykdkz",
                                  "is_leaf": true,
                                  "children": [
                                    {
                                      "id": "bwprn4sy",
                                      "name": "Varanus panopte 2",
                                      "branch_length": 0.001337852301105974,
                                      "parent": "tw7cdkdq",
                                      "conservation_status": "LC",
                                      "conservation_source": "IUCN Red List (search match)",
                                      "iucn_year_published": "2018",
                                      "is_leaf": true
                                    },
                                    {
                                      "id": "my33yd61",
                                      "name": "Inner3",
                                      "branch_length": 8.919015340705383e-05,
                                      "parent": "tw7cdkdq",
                                      "is_leaf": true,
                                      "children": [
                                        {
                                          "id": "4dd8ftu1",
                                          "name": "Varanus spencer",
                                          "branch_length": 0.0012486621476989201,
                                          "parent": "my33yd61",
                                          "conservation_status": "LC",
                                          "conservation_source": "IUCN Red List (search match)",
                                          "iucn_year_published": "2018",
                                          "is_leaf": true
                                        },
                                        {
                                          "id": "cvrudocv",
                                          "name": "Varanus mertens",
                                          "branch_length": 0.0012486621476989201,
                                          "parent": "my33yd61",
                                          "conservation_status": "EN",
                                          "conservation_source": "IUCN Red List (search match)",
                                          "iucn_year_published": "2018",
                                          "is_leaf": true
                                        }
                                      ],
                                      "is_internal": true
                                    }
                                  ],
                                  "is_internal": true
                                }
                              ],
                              "is_internal": true
                            }
                          ],
                          "is_internal": true
                        },
                        {
                          "id": "nnll9djk",
                          "name": "Inner13",
                          "branch_length": 0.00017298012174456808,
                          "parent": "c13g4nq5",
                          "is_leaf": true,
                          "children": [
                            {
                              "id": "eju4dksm",
                              "name": "Varanus indicus",
                              "branch_length": 0.0028039154477345566,
                              "parent": "nnll9djk",
                              "conservation_status": "LC",
                              "conservation_source": "IUCN Red List",
                              "iucn_year_published": "2021",
                              "possibly_extinct": false,
                              "is_leaf": true
                            },
                            {
                              "id": "jssmpy35",
                              "name": "Inner12",
                              "branch_length": 0.0003400374598644274,
                              "parent": "nnll9djk",
                              "is_leaf": true,
                              "children": [
                                {
                                  "id": "ltoovt5u",
                                  "name": "Varanus togianu",
                                  "branch_length": 0.002463877987870129,
                                  "parent": "jssmpy35",
                                  "conservation_status": "LC",
                                  "conservation_source": "IUCN Red List (search match)",
                                  "iucn_year_published": "2021",
                                  "is_leaf": true
                                },
                                {
                                  "id": "49yun527",
                                  "name": "Inner11",
                                  "branch_length": 8.0828576525146e-05,
                                  "parent": "jssmpy35",
                                  "is_leaf": true,
                                  "children": [
                                    {
                                      "id": "8aebucco",
                                      "name": "Inner9",
                                      "branch_length": 0.0003316758829825092,
                                      "parent": "49yun527",
                                      "is_leaf": true,
                                      "children": [
                                        {
                                          "id": "asi3lk4w",
                                          "name": "Varanus glebopa",
                                          "branch_length": 0.002051373528362474,
                                          "parent": "8aebucco",
                                          "conservation_status": "LC",
                                          "conservation_source": "IUCN Red List (search match)",
                                          "iucn_year_published": "2018",
                                          "is_leaf": true
                                        },
                                        {
                                          "id": "f78d5g8r",
                                          "name": "Inner4",
                                          "branch_length": 0.0007135212272565,
                                          "parent": "8aebucco",
                                          "is_leaf": true,
                                          "children": [
                                            {
                                              "id": "zab70u86",
                                              "name": "Inner2",
                                              "branch_length": 8.919015340705383e-05,
                                              "parent": "f78d5g8r",
                                              "is_leaf": true,
                                              "children": [
                                                {
                                                  "id": "6ycsuq5b",
                                                  "name": "Varanus glauert",
                                                  "branch_length": 0.0012486621476989201,
                                                  "parent": "zab70u86",
                                                  "conservation_status": "LC",
                                                  "conservation_source": "IUCN Red List (search match)",
                                                  "iucn_year_published": "2018",
                                                  "is_leaf": true
                                                },
                                                {
                                                  "id": "rrgamkio",
                                                  "name": "Varanus brevica",
                                                  "branch_length": 0.0012486621476989201,
                                                  "parent": "zab70u86",
                                                  "conservation_status": "LC",
                                                  "conservation_source": "IUCN Red List (search match)",
                                                  "iucn_year_published": "2018",
                                                  "is_leaf": true
                                                }
                                              ],
                                              "is_internal": true
                                            },
                                            {
                                              "id": "3lc6rnap",
                                              "name": "Varanus tristis",
                                              "branch_length": 0.001337852301105974,
                                              "parent": "f78d5g8r",
                                              "conservation_status": "LC",
                                              "conservation_source": "IUCN Red List",
                                              "iucn_year_published": "2018",
                                              "possibly_extinct": false,
                                              "is_leaf": true
                                            }
                                          ],
                                          "is_internal": true
                                        }
                                      ],
                                      "is_internal": true
                                    },
                                    {
                                      "id": "yz8bj2vi",
                                      "name": "Inner8",
                                      "branch_length": 0.0004208660363895769,
                                      "parent": "49yun527",
                                      "is_leaf": true,
                                      "children": [
                                        {
                                          "id": "2vb72gth",
                                          "name": "Varanus scalari",
                                          "branch_length": 0.0019621833749554063,
                                          "parent": "yz8bj2vi",
                                          "conservation_status": "LC",
                                          "conservation_source": "IUCN Red List (search match)",
                                          "iucn_year_published": "2018",
                                          "is_leaf": true
                                        },
                                        {
                                          "id": "uj5i7262",
                                          "name": "Inner7",
                                          "branch_length": 0.00026757046022118924,
                                          "parent": "yz8bj2vi",
                                          "is_leaf": true,
                                          "children": [
                                            {
                                              "id": "5ad43fh3",
                                              "name": "Varanus semirem",
                                              "branch_length": 0.001694612914734217,
                                              "parent": "uj5i7262",
                                              "conservation_status": "LC",
                                              "conservation_source": "IUCN Red List (search match)",
                                              "iucn_year_published": "2018",
                                              "is_leaf": true
                                            },
                                            {
                                              "id": "0qvvj6hg",
                                              "name": "Inner1",
                                              "branch_length": 0.0006243310738494601,
                                              "parent": "uj5i7262",
                                              "is_leaf": true,
                                              "children": [
                                                {
                                                  "id": "bzatj8wp",
                                                  "name": "Varanus salvado",
                                                  "branch_length": 0.001070281840884757,
                                                  "parent": "0qvvj6hg",
                                                  "conservation_status": "LC",
                                                  "conservation_source": "IUCN Red List (search match)",
                                                  "iucn_year_published": "2016",
                                                  "is_leaf": true
                                                },
                                                {
                                                  "id": "hi2iz0vu",
                                                  "name": "Varanus komodoe",
                                                  "branch_length": 0.001070281840884757,
                                                  "parent": "0qvvj6hg",
                                                  "conservation_status": "R",
                                                  "conservation_source": "IUCN Red List (search match)",
                                                  "iucn_year_published": "1988",
                                                  "is_leaf": true
                                                }
                                              ],
                                              "is_internal": true
                                            }
                                          ],
                                          "is_internal": true
                                        }
                                      ],
                                      "is_internal": true
                                    }
                                  ],
                                  "is_internal": true
                                }
                              ],
                              "is_internal": true
                            }
                          ],
                          "is_internal": true
                        }
                      ],
                      "is_internal": true
                    }
                  ],
                  "is_internal": true
                }
              ],
              "is_internal": true
            }
          ],
          "is_internal": true
        }
      ],
      "is_internal": true
    }
  ],
  "is_internal": true
};
            
            // Status colors
            const statusColors = {"EX": "#000000", "EW": "#8B008B", "CR": "#FF0000", "EN": "#FF8C00", "VU": "#FFD700", "NT": "#9ACD32", "LC": "#32CD32", "DD": "#808080", "NE": "#A9A9A9", "Query": "#0000FF"};
            
            // Set dimensions and margins
            const margin = {top: 20, right: 120, bottom: 20, left: 120};
            const width = 1200 - margin.left - margin.right;
            const height = 800 - margin.bottom - margin.top;
            
            // Create SVG
            const svg = d3.select("#tree")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom);
                
            const g = svg.append("g")
                .attr("transform", `translate(${margin.left},${margin.top})`);
            
            // Create tree layout
            const tree = d3.tree().size([height, width]);
            
            // Create hierarchy
            const root = d3.hierarchy(treeData);
            
            // Generate tree
            tree(root);
            
            // Add zoom behavior
            const zoom = d3.zoom()
                .scaleExtent([0.1, 3])
                .on("zoom", (event) => {
                    g.attr("transform", event.transform);
                });
            
            svg.call(zoom);
            
            // Create tooltip
            const tooltip = d3.select(".tooltip");
            
            // Add links
            const link = g.selectAll(".link")
                .data(root.descendants().slice(1))
                .enter().append("path")
                .attr("class", "link")
                .attr("d", d => {
                    if (!d.parent) return "";
                    return `M${d.y},${d.x} C${(d.y + d.parent.y) / 2},${d.x} ${(d.y + d.parent.y) / 2},${d.parent.x} ${d.parent.y},${d.parent.x}`;
                })
                .style("stroke-width", d => Math.max(1, 3 - d.depth));
            
            // Add nodes
            const node = g.selectAll(".node")
                .data(root.descendants())
                .enter().append("g")
                .attr("class", d => {
                    let classes = "node";
                    if (d.data.is_query) classes += " query";
                    return classes;
                })
                .attr("transform", d => `translate(${d.y},${d.x})`);
            
            // Add circles for nodes
            node.append("circle")
                .attr("r", d => d.data.is_query ? 8 : 5)
                .style("fill", d => {
                    const status = d.data.conservation_status || "DD";
                    return statusColors[status] || statusColors["DD"];
                })
                .style("opacity", 0.8)
                .on("mouseover", function(event, d) {
                    // Highlight node
                    d3.select(this).style("opacity", 1).attr("r", d.data.is_query ? 10 : 7);
                    
                    // Show tooltip
                    const status = d.data.conservation_status || "DD";
                    const similarity = d.data.similarity ? `${(d.data.similarity * 100).toFixed(1)}%` : "N/A";
                    
                    let tooltipContent = `
                        <strong>${d.data.name || "Internal Node"}</strong><br/>
                        <strong>Conservation Status:</strong> ${status}<br/>
                    `;
                    
                    if (d.data.similarity) {
                        tooltipContent += `<strong>Similarity:</strong> ${similarity}<br/>`;
                    }
                    
                    if (d.data.branch_length) {
                        tooltipContent += `<strong>Branch Length:</strong> ${d.data.branch_length.toFixed(4)}<br/>`;
                    }
                    
                    if (d.data.iucn_year_published) {
                        tooltipContent += `<strong>IUCN Year:</strong> ${d.data.iucn_year_published}<br/>`;
                    }
                    
                    if (d.data.conservation_source) {
                        tooltipContent += `<strong>Source:</strong> ${d.data.conservation_source}<br/>`;
                    }
                    
                    tooltip.transition().duration(200).style("opacity", .9);
                    tooltip.html(tooltipContent)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function(event, d) {
                    // Reset node
                    d3.select(this).style("opacity", 0.8).attr("r", d.data.is_query ? 8 : 5);
                    
                    // Hide tooltip
                    tooltip.transition().duration(500).style("opacity", 0);
                });
            
            // Add labels
            node.append("text")
                .attr("dy", ".35em")
                .attr("x", d => d.children || d._children ? -13 : 13)
                .style("text-anchor", d => d.children || d._children ? "end" : "start")
                .style("font-size", d => d.data.is_query ? "14px" : "12px")
                .style("font-weight", d => d.data.is_query ? "bold" : "normal")
                .style("fill", d => {
                    const status = d.data.conservation_status || "DD";
                    return statusColors[status] || statusColors["DD"];
                })
                .text(d => {
                    if (!d.data.name) return "";
                    let name = d.data.name.replace(/_/g, " ");
                    if (d.data.is_query) name = "ðŸŽ¯ " + name + " (QUERY)";
                    return name;
                });
            
            // Control functions
            window.expandAll = function() {
                node.each(function(d) {
                    if (d._children) {
                        d.children = d._children;
                        d._children = null;
                    }
                });
                update();
            };
            
            window.collapseAll = function() {
                node.each(function(d) {
                    if (d.children) {
                        d._children = d.children;
                        d.children = null;
                    }
                });
                update();
            };
            
            window.resetZoom = function() {
                svg.transition().duration(750).call(
                    zoom.transform,
                    d3.zoomIdentity
                );
            };
            
            window.downloadSVG = function() {
                const svgData = new XMLSerializer().serializeToString(svg.node());
                const svgBlob = new Blob([svgData], {type: "image/svg+xml;charset=utf-8"});
                const svgUrl = URL.createObjectURL(svgBlob);
                const downloadLink = document.createElement("a");
                downloadLink.href = svgUrl;
                downloadLink.download = "phylogenetic_tree_Varanus_komodoensis.svg";
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
            };
            
            function update() {
                // Re-render tree (simplified for this example)
                location.reload();
            }
            
            // Add branch length scale
            const scale = g.append("g")
                .attr("class", "scale")
                .attr("transform", `translate(50, ${height - 50})`);
            
            scale.append("line")
                .attr("x1", 0)
                .attr("x2", 100)
                .attr("y1", 0)
                .attr("y2", 0)
                .style("stroke", "#333")
                .style("stroke-width", 2);
            
            scale.append("text")
                .attr("x", 50)
                .attr("y", -10)
                .style("text-anchor", "middle")
                .style("font-size", "12px")
                .text("0.1 substitutions/site");
        </script>
    </body>
    </html>
    